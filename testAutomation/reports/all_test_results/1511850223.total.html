[4mRunning "env:test" (env) task[24m

[4mRunning "mochaTest:kmp_id" (mochaTest) task[24m
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test 01 : submission is rejected if id is undefined</dt>
            <dd><pre><code>var test = submission.isNew( undefined, instanceId );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test 02 : submission is rejected if id is null</dt>
            <dd><pre><code>var test = submission.isNew( null, instanceId );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test 03 : submission is rejected if id is false</dt>
            <dd><pre><code>var test = submission.isNew( undefined, instanceId );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test 04 : submission returns true for not-previously logged submissions</dt>
            <dd><pre><code>var test = submission.isNew( id, instanceId );
return expect( test ).to.eventually.equal( true );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test 05: submission returns false for previously logged submissions</dt>
            <dd><pre><code>var test = submission.isNew( id, instanceId )
    .then( function() {
        return submission.isNew( id, instanceId );
    } );
return expect( test ).to.eventually.equal( false );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>

[4mRunning "karma:headless" (karma) task[24m
[32m28 11 2017 06:24:08.216:INFO [framework.browserify]: [39mbundle built
[32m28 11 2017 06:24:08.247:INFO [karma]: [39mKarma v1.7.1 server started at http://0.0.0.0:9876/
[32m28 11 2017 06:24:08.247:INFO [launcher]: [39mLaunching browser ChromeHeadless with unlimited concurrency
[32m28 11 2017 06:24:08.366:INFO [launcher]: [39mStarting browser ChromeHeadless
[31m28 11 2017 06:24:08.383:ERROR [launcher]: [39mNo binary for ChromeHeadless browser on your platform.
  Please, set "CHROME_BIN" env variable.
[33mWarning: Task "karma:headless" failed. Use --force to continue.[39m

[31mAborted due to warnings.[39m


[4mExecution Time[24m[90m (2017-11-28 06:23:46 UTC-0)[39m
loading tasks     [34m15.1s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 68%[39m
mochaTest:kmp_id   [34m1.6s[39m  [34mâ–‡â–‡â–‡â–‡ 7%[39m
karma:headless     [34m5.5s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 25%[39m
[35mTotal 22.2s[39m

[4mRunning "env:test" (env) task[24m

[4mRunning "mochaTest:kmp_instanceId" (mochaTest) task[24m
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test: 06 submission is rejected if instanceId is undefined</dt>
            <dd><pre><code>var test = submission.isNew( id, undefined );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test: 07 submission is rejected if instanceId is null</dt>
            <dd><pre><code>var test = submission.isNew( id, null );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test: 08 submission is rejected if instanceId is false</dt>
            <dd><pre><code>var test = submission.isNew( id, false );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>isNew() check</h1>
          <dl>
            <dt>Test: 009 is rejected if instanceId is undefined</dt>
            <dd><pre><code>var test = submission.isNew( id, undefined );
return expect( test ).to.eventually.be.rejected.and.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>

[4mRunning "karma:headless" (karma) task[24m
[32m28 11 2017 06:24:15.446:INFO [framework.browserify]: [39mbundle built
[32m28 11 2017 06:24:15.489:INFO [karma]: [39mKarma v1.7.1 server started at http://0.0.0.0:9876/
[32m28 11 2017 06:24:15.490:INFO [launcher]: [39mLaunching browser ChromeHeadless with unlimited concurrency
[32m28 11 2017 06:24:15.508:INFO [launcher]: [39mStarting browser ChromeHeadless
[31m28 11 2017 06:24:15.509:ERROR [launcher]: [39mNo binary for ChromeHeadless browser on your platform.
  Please, set "CHROME_BIN" env variable.
[33mWarning: Task "karma:headless" failed. Use --force to continue.[39m

[31mAborted due to warnings.[39m


[4mExecution Time[24m[90m (2017-11-28 06:24:09 UTC-0)[39m
loading tasks              [34m1.8s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 29%[39m
mochaTest:kmp_instanceId  [34m187ms[39m  [34mâ–‡â–‡ 3%[39m
karma:headless             [34m4.1s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 68%[39m
[35mTotal 6s[39m

[4mRunning "env:test" (env) task[24m

[4mRunning "mochaTest:kmp_set_survey" (mochaTest) task[24m
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to store new surveys</h1>
          <dl>
            <dt>Test 015: store_survey returns an error if the OpenRosa Form ID is missing</dt>
            <dd><pre><code>delete survey.openRosaId;
return expect( model.set( survey ) ).to.eventually.be.rejected;</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to store new surveys</h1>
          <dl>
            <dt>Test 016: store_survey returns an error if the OpenRosa Form ID is an empty string</dt>
            <dd><pre><code>survey.openRosaId = &#x27;&#x27;;
return expect( model.set( survey ) ).to.eventually.be.rejected;</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to store new surveys</h1>
          <dl>
            <dt>Test 017:  store_survey returns an error if the OpenRosa Server is an empty string</dt>
            <dd><pre><code>survey.openRosaServer = &#x27;&#x27;;
return expect( model.set( survey ) ).to.eventually.be.rejected;</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to store new surveys</h1>
          <dl>
            <dt>Test 018:  store_survey returns an enketo id if survey is stored successfully</dt>
            <dd><pre><code>return expect( model.set( survey ) ).to.eventually.equal(&#x27;YYYp&#x27; );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Survey Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to store new surveys</h1>
          <dl>
            <dt>Test 014: store_survey returns an error if the OpenRosa Server is missing</dt>
            <dd><pre><code>delete survey.openRosaServer;
return expect( model.set( survey ) ).to.eventually.be.rejected;</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>

[4mRunning "karma:headless" (karma) task[24m
[32m28 11 2017 06:24:22.360:INFO [framework.browserify]: [39mbundle built
[32m28 11 2017 06:24:22.377:INFO [karma]: [39mKarma v1.7.1 server started at http://0.0.0.0:9876/
[32m28 11 2017 06:24:22.377:INFO [launcher]: [39mLaunching browser ChromeHeadless with unlimited concurrency
[32m28 11 2017 06:24:22.383:INFO [launcher]: [39mStarting browser ChromeHeadless
[31m28 11 2017 06:24:22.384:ERROR [launcher]: [39mNo binary for ChromeHeadless browser on your platform.
  Please, set "CHROME_BIN" env variable.
[33mWarning: Task "karma:headless" failed. Use --force to continue.[39m

[31mAborted due to warnings.[39m


[4mExecution Time[24m[90m (2017-11-28 06:24:16 UTC-0)[39m
loading tasks              [34m1.6s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 27%[39m
mochaTest:kmp_set_survey  [34m420ms[39m  [34mâ–‡â–‡â–‡ 7%[39m
karma:headless             [34m3.9s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 66%[39m
[35mTotal 6s[39m

[4mRunning "env:test" (env) task[24m

[4mRunning "mochaTest:kmp_cache_instance" (mochaTest) task[24m
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to cache an instance</h1>
          <dl>
            <dt>Test 019: cache_instance returns an 400 error when instanceId is missing</dt>
            <dd><pre><code>delete survey.instanceId;
return expect( model.set( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to cache an instance</h1>
          <dl>
            <dt>Test 020: cache_instance returns an 400 error when openRosaId is missing</dt>
            <dd><pre><code>delete survey.openRosaId;
return expect( model.set( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to cache an instance</h1>
          <dl>
            <dt>Test 021: cache_instance returns an 400 error when openRosaServer is missing</dt>
            <dd><pre><code>delete survey.openRosaServer;
return expect( model.set( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to cache an instance</h1>
          <dl>
            <dt>Test 022: cache_instance returns an 400 error when instance is missing</dt>
            <dd><pre><code>delete survey.instance;
return expect( model.set( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to cache an instance</h1>
          <dl>
            <dt>Test 023: cache_instance returns the survey object when the instance is cached successfully</dt>
            <dd><pre><code>return expect( model.set( survey ) ).to.eventually.deep.equal( survey );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>set: when attempting to cache an instance</h1>
          <dl>
            <dt>Test 024: get_cached_instance returns an 400 error when instanceId is missing</dt>
            <dd><pre><code>delete survey.instanceId;
return expect( model.get( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>

[4mRunning "karma:headless" (karma) task[24m
[32m28 11 2017 06:24:29.215:INFO [framework.browserify]: [39mbundle built
[32m28 11 2017 06:24:29.232:INFO [karma]: [39mKarma v1.7.1 server started at http://0.0.0.0:9876/
[32m28 11 2017 06:24:29.232:INFO [launcher]: [39mLaunching browser ChromeHeadless with unlimited concurrency
[32m28 11 2017 06:24:29.238:INFO [launcher]: [39mStarting browser ChromeHeadless
[31m28 11 2017 06:24:29.239:ERROR [launcher]: [39mNo binary for ChromeHeadless browser on your platform.
  Please, set "CHROME_BIN" env variable.
[33mWarning: Task "karma:headless" failed. Use --force to continue.[39m

[31mAborted due to warnings.[39m


[4mExecution Time[24m[90m (2017-11-28 06:24:23 UTC-0)[39m
loading tasks                  [34m1.5s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 25%[39m
mochaTest:kmp_cache_instance  [34m233ms[39m  [34mâ–‡â–‡ 4%[39m
karma:headless                 [34m4.2s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 71%[39m
[35mTotal 6s[39m

[4mRunning "env:test" (env) task[24m

[4mRunning "mochaTest:kmp_obtain_cached_instance" (mochaTest) task[24m
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>get: when attempting to obtain a cached instance</h1>
          <dl>
            <dt>Test 25 : obtain_cached_instance returns an 400 error when instanceId is missing</dt>
            <dd><pre><code>delete survey.instanceId;
return expect( model.get( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 400 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>get: when attempting to obtain a cached instance</h1>
          <dl>
            <dt>Test 26 : obtain_cached_instance returns an 404 error when instance record not cached</dt>
            <dd><pre><code>survey.instanceId = &#x27;non-existing&#x27;;
return expect( model.get( survey ) ).to.eventually.be.rejected
    .and.to.have.property( &#x27;status&#x27; ).that.equals( 404 );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Instance Model</h1>
      <dl>
        <section class="suite">
          <h1>get: when attempting to obtain a cached instance</h1>
          <dl>
            <dt>Test 27 : obtain_cached_instance returns the survey object with the instance property when successful</dt>
            <dd><pre><code>promise = model.set( survey ).then( model.get );
return Promise.all( [
    expect( promise ).to.eventually
    .have.property( &#x27;instance&#x27; ).that.equals( survey.instance ),
    expect( promise ).to.eventually.
    have.property( &#x27;returnUrl&#x27; ).that.equals( survey.returnUrl )
] );</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>

[4mRunning "karma:headless" (karma) task[24m
[32m28 11 2017 06:24:35.855:INFO [framework.browserify]: [39mbundle built
[32m28 11 2017 06:24:35.871:INFO [karma]: [39mKarma v1.7.1 server started at http://0.0.0.0:9876/
[32m28 11 2017 06:24:35.871:INFO [launcher]: [39mLaunching browser ChromeHeadless with unlimited concurrency
[32m28 11 2017 06:24:35.877:INFO [launcher]: [39mStarting browser ChromeHeadless
[31m28 11 2017 06:24:35.878:ERROR [launcher]: [39mNo binary for ChromeHeadless browser on your platform.
  Please, set "CHROME_BIN" env variable.
[33mWarning: Task "karma:headless" failed. Use --force to continue.[39m

[31mAborted due to warnings.[39m


[4mExecution Time[24m[90m (2017-11-28 06:24:30 UTC-0)[39m
loading tasks              [34m1.6s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡ 27%[39m
mochaTest:k...d_instance  [34m226ms[39m  [34mâ–‡ 4%[39m
karma:headless               [34m4s[39m  [34mâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡ 69%[39m
[35mTotal 5.7s[39m

